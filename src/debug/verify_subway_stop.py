import pickle as pkl
import numpy as np
import json
normalized_score = np.array(pkl.load(open('../../data/normalized_subway_scores.pkl', 'rb')))

mat = normalized_score[:,1].reshape((65,65)).astype(np.float).tolist()
print(mat)

np.savetxt("../../data/subway_scores.csv", mat, delimiter=",")

# with open('../../data/locations_v2.json') as json_file:
#
#     json_body = json.load(json_file)
#
#     # read from locations_v2.json
#     all_locations = json_body["locations"].copy()
#     lats = []
#     lngs = []
#     for location in all_locations:
#         # print(location)
#         id = location['id']
#         lats.append(location['coords']['lat'])
#         lngs.append(location['coords']['lng'])
#
#     lat_diff = 0.0013690324491903993
#     lng_diff = np.mean([0.001645962522360378, 0.0016459887730206901, 0.00164601502547157, 0.0016460412796845958,
#                         0.0016460675356881893, 0.0016460937934681397, 0.0016461200530244469, 0.001646146314357111,
#                         0.0016461725774661318, 0.0016461988423515095, 0.0016462251090274549, 0.0016462513774655463,
#                         0.0016462776476942054, 0.0016463039196850104, 0.0016463301934663832, 0.0016463564690241128,
#                         0.0016463827463724101, 0.0016464090254828534, 0.0016464353063838644, 0.0016464615890470213,
#                         0.001646487873500746, 0.0016465141597308275, 0.0016465404477514767, 0.0016465667375342719,
#                         0.0016465930291076347, 0.0016466193224573544, 0.0016466456175976418, 0.0016466719145000752,
#                         0.0016466982131930763, 0.0016467245136624342, 0.001646750815908149, 0.0016467771199444314,
#                         0.0016468034257570707, 0.0016468297333460669, 0.0016468560427256307, 0.0016468823538815514,
#                         0.0016469086668138289, 0.001646934981536674, 0.001646961298035876, 0.001646987616311435,
#                         0.0016470139363633507, 0.001647040258205834, 0.0016470665818388852, 0.0016470929072482932,
#                         0.001647119234434058, 0.0016471455633961796, 0.0016471718941488689, 0.001647198226692126,
#                         0.001647224560997529, 0.0016472508971077104, 0.001647277234980038, 0.001647303574657144,
#                         0.0016473299160963961, 0.0016473562593262159, 0.0016473826043466033, 0.0016474089511433476,
#                         0.0016474352997164488, 0.0016474616500801176, 0.001647488002234354, 0.0016475143561649475,
#                         0.0016475407118718977, 0.0016475670693694155, 0.0016475934286575011, 0.0016476197897219436,
#                         0.0016476461525769537])
#     print('min lat', np.min(lats))
#     print('min lng', np.min(lngs))
#     print('max lat', np.max(lats) + lat_diff)
#     print('max lng', np.max(lngs) + lng_diff)

with open('../../data/subway_map.json') as json_file:
    subwaymap = np.array([(int(k), bool(v)) for k, v in json.load(json_file).items()])
    print(subwaymap)
    mat = subwaymap[:, 1].reshape((65, 65)).astype(np.int).tolist()
    print(mat)
    np.savetxt("../../data/subwaymap.csv", mat, delimiter=",")
